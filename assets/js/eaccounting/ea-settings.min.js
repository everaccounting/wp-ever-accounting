jQuery(document).ready(function(r){var t;window.formfield="",r("body").on("click",".ea_settings_upload_button",function(e){e.preventDefault();e=r(this);window.formfield=r(this).parent().prev(),t||((t=wp.media.frames.file_frame=wp.media({frame:"post",state:"insert",title:e.data("uploader_title"),button:{text:e.data("uploader_button_text")},multiple:!1})).on("menu:render:default",function(e){e.unset("library-separator"),e.unset("gallery"),e.unset("featured-image"),e.unset("embed"),e.set({})}),t.on("insert",function(){t.state().get("selection").each(function(e,t){e=e.toJSON(),window.formfield.val(e.url)})})),t.open()}),r(".ea-financial-start").datepicker("destroy"),r(".ea-financial-start").datepicker({dateFormat:"dd-mm"});var n={init:function(){r("#ea-currency-settings").on("change",".ea_currencies_code select",this.populate_currency).on("click","#ea_add_currency",this.add_currency).on("click",".ea_remove_currency",this.remove_currency).on("submit",this.submit)},block:function(){r("#ea-currency-settings").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),r("#ea-currency-settings button").attr("disabled","disabled")},unblock:function(){r("#ea-currency-settings").unblock(),r("#ea-currency-settings button").removeAttr("disabled")},add_currency:function(e){e.preventDefault(),r(".ea-select2").select2("destroy");var t=r("#ea_currencies tr:last"),e=t.clone(),n=t.parent().find("tr").length;return e.find("td input").not(":input[type=checkbox]").val(""),e.find('td [type="checkbox"]').attr("checked",!1),e.find("input, select").each(function(){var e=r(this).attr("name");e.includes("code")&&r(this).val(""),e=e.replace(/\[(\d+)\]/,"["+parseInt(n)+"]"),r(this).attr("name",e).attr("id",e)}),e.insertAfter(t),r(document.body).trigger("ea_select2_init"),!1},remove_currency:function(e){if(e.preventDefault(),r("#ea_currencies tbody tr").length<2)return r.eaccounting_notice({message:"Last item is not removable."}),!1;r(this).closest("tr").remove()},populate_currency:function(){var e=r(this).val();e&&(e=eaccounting_codes[e],r(this).closest("tr").find(".ea_currencies_rate input").val("1.0000").end().find(".ea_currencies_precision input").val(e.precision).end().find(".ea_currencies_position select").val(e.position).end().find(".ea_currencies_decimal_separator input").val(e.decimal_separator).end().find(".ea_currencies_thousand_separator input").val(e.thousand_separator).end())},submit:function(e){e.preventDefault(),n.block();e=r("#ea-currency-settings").serializeObject();r.post(ajaxurl,e,function(e){}).always(function(e){r.eaccounting_notice(e),n.unblock()})}};n.init()});