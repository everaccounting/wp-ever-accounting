jQuery(function(i){i.fn.eaccounting_creatable=function(e){return this.each(function(){new i.eaccounting_creatable(this,e)})},i.eaccounting_creatable=function(e,n){this.defaults={option:function(e){return{id:e.id,text:e.name}},template:undefined,onReady:undefined,onSubmit:undefined},this.el=e,this.$el=i(e),this.options=i.extend(this.defaults,n);var o=this;return this.block=function(){o.$el.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},this.unblock=function(){o.$el.unblock()},this.onError=function(e){console.warn(e),o.unblock()},this.init_plugins=function(){i(".ea-select2",this.$el).eaccounting_select2(),i(".ea-input-color",this.$el).ea_color_picker()},this.handleSubmit=function(e,t){o.block(),t.disableSubmit(),"function"==typeof o.options.onSubmit&&o.options.onSubmit(o.$el,e,t),wp.ajax.send({data:e,success:function(e){var n=o.options.option(e.item);o.$el.eaccounting_select2({data:[n]}),o.$el.val(n.id).trigger("change"),i.eaccounting_notice(e.message,"success"),t.closeModal(),t.enableSubmit()},error:function(e){i.eaccounting_notice(e.message,"error"),t.enableSubmit()}})},this.handleModal=function(e,n,t){e.preventDefault(),n.is(o.$el)&&(e.preventDefault(),i(this).ea_modal({template:"ea-modal-"+t,onSubmit:o.handleSubmit,onReady:function(e,n){"function"==typeof o.options.onReady&&o.options.onReady(o.$el,n,o)}}))},this.init=function(){i(document).on("ea_trigger_creatable",o.handleModal).on("ea_modal_loaded",o.init_plugins)},this.init(),this},i("#currency_code").eaccounting_creatable({option:function(e){return{id:e.code,text:e.name+" ("+e.symbol+")"}}}),i("#account_id,#customer_id,#vendor_id").eaccounting_creatable(),i("#category_id").eaccounting_creatable({onReady:function(e,n){e=e.data("type");e||console.warn("No category type defined"),i("#type",n.$el).val(e.replace("_category",""))}})});