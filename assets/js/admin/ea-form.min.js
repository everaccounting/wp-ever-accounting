!function(e){"undefined"!=typeof eaccounting_form_i10n&&(e.fn.eaccounting_form=function(n){return this.each(function(){new e.eaccounting_form(this,n)})},e.eaccounting_form=function(n,c){var o={};o.el=n,o.$el=e(n),o.options=c,o.account_id=e("#account_id, #from_account_id",o.$el),o.currency_code=e("#currency_code",o.$el),o.amount=e("#amount, #opening_balance",o.$el),o.block=function(){o.$el.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},o.unblock=function(){o.$el.unblock()},o.onError=function(n){console.warn(n),o.unblock()},o.maskAmount=function(n){console.log(n),o.amount.inputmask("decimal",{alias:"numeric",groupSeparator:n.thousand_separator,autoGroup:!0,digits:n.precision,radixPoint:n.decimal_separator,digitsOptional:!1,allowMinus:!1,prefix:n.symbol,placeholder:"0.000",rightAlign:0})},o.getCurrency=function(n,c,o){console.log(n),wp.ajax.send("eaccounting_get_currency",{data:{code:n,_wpnonce:eaccounting_form_i10n.nonce.get_currency},success:c,error:o})},o.getAccount=function(n,c,o){wp.ajax.send("eaccounting_get_account",{data:{id:n,_wpnonce:eaccounting_form_i10n.nonce.get_account},success:c,error:o})},o.$el.on("submit",function(n){n.preventDefault(),o.block(),wp.ajax.post(o.$el.serializeArray()).then(function(n){n=e.extend(!0,{},{message:"",redirect:""},n),o.unblock(),e.eaccounting_notice(n.message,"success"),eaccounting.redirect(n.redirect)}).fail(function(n){console.log(n),o.unblock(),e.eaccounting_notice(n.message,"error")})}),o.currency_code.on("change",function(){var n;o.amount.length&&(n=o.currency_code.val(),o.block(),o.getCurrency(n,function(n){o.maskAmount(n),o.unblock()},o.onError))}),o.account_id.on("change",function(){if(o.amount.length){var n=o.account_id.val(),c=parseInt(n,10);if(!c)return;o.block(),o.getAccount(c,function(n){o.getCurrency(n.currency_code,function(n){o.maskAmount(n),o.unblock()},o.onError)},o.onError)}}),o.account_id.trigger("change"),o.currency_code.trigger("change")},e(document).ready(function(){e("#ea-account-form, #ea-revenue-form, #ea-payment-form").eaccounting_form()}))}(jQuery);