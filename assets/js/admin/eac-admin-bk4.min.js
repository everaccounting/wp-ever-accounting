!function(o,i,n){"use strict";var a=function(t,e){var a=eac_admin_vars.base_currency,e=eac_admin_vars.currencies[e]||eac_admin_vars.currencies[a],a=e.decimal_separator,i=e.thousand_separator,n=e.precision,c=e.position,e=e.symbol;t.inputmask("decimal",{alias:"numeric",groupSeparator:i,autoGroup:!0,digits:n,radixPoint:a,digitsOptional:!1,allowMinus:!0,rightAlign:!1,prefix:"before"===c?e:"",suffix:"after"===c?e:""})},c=function(t){o('[form="'+t.attr("id")+'"]').removeAttr("disabled"),t.unblock()},r=function(t){o('[form="'+t.attr("id")+'"]').removeAttr("disabled"),t.unblock()},s=function(t){if("object"==typeof t){if(!("redirect"in(t="data"in t?t.data:t)))return;t=t.redirect}var e,a;if(t)return!!(t=t.trim())&&(a=-1!==(e=navigator.userAgent.toLowerCase()).indexOf("msie"),e=parseInt(e.substr(4,2),10),a&&e<9?((a=n.createElement("a")).href=t,n.body.appendChild(a),a.click()):void(i.location.href=t))},d=function(t,e,a){if("object"==typeof t){if("data"in t&&(e=t.success&&!0===t.success?"success":"error",t=t.data),!("message"in t))return;t=t.message}if(t){if(!(t=t.trim()))return!1;a=o.extend(!0,{},{appendTo:"body",stack:!1,customClass:!1,type:"success",offset:{from:"bottom",amount:50},align:"right",minWidth:250,maxWidth:450,delay:4e3,spacing:10},a);var e='<div class="eac-notification notice notice-'+(e||a.type)+" "+(a.customClass||"")+'">',i=(e=e+t+"</div>",a.offset.amount),t=((a.stack?o(a.appendTo).find(".eac-notification"):o(".eac-notification")).each(function(){return i=Math.max(i,parseInt(o(this).css(a.offset.from))+this.offsetHeight+a.spacing)}),{position:"body"===a.appendTo?"fixed":"absolute",margin:0,"z-index":"9999",display:"none","min-width":a.minWidth,"max-width":a.maxWidth}),n=(t[a.offset.from]=i+"px",o(e).css(t).appendTo(a.appendTo));switch(a.align){case"center":n.css({left:"50%","margin-left":"-"+n.outerWidth()/2+"px"});break;case"left":n.css("left","20px");break;default:n.css("right","20px")}return n.fadeIn?n.fadeIn():n.css({display:"block",opacity:1}),0<a.delay&&setTimeout(c,a.delay),n.click(c),n}function c(){o.eac_notification.remove(n)}};function t(){o(n).trigger("init-select2"),o(n).trigger("init-datepicker"),o(n).trigger("init-tooltip"),o(n).trigger("init-form")}o(n).on("init-select2",function(){o(":input.eac-select2").filter(":not(.enhanced)").each(function(){var t={allowClear:o(this).data("allow_clear")&&!o(this).prop("multiple")||!0,placeholder:o(this).data("placeholder")||o(this).attr("placeholder")||"",minimumInputLength:o(this).data("minimum_input_length")?o(this).data("minimum_input_length"):0,ajax:{url:eac_admin_vars.ajax_url,dataType:"json",delay:250,method:"POST",data:function(t){return{term:t.term,action:o(this).data("action"),type:o(this).data("type"),_wpnonce:eac_admin_vars.search_nonce,exclude:o(this).data("exclude"),include:o(this).data("include"),limit:o(this).data("limit")}},processResults:function(t){return t.page=t.page||1,t},cache:!0}};o(this).data("action")||delete t.ajax,o(this).closest(".eac-form").length&&(t.dropdownParent=o(this).closest(".eac-form")),o(this).select2(t).addClass("enhanced")})}),o(n).on("init-form",function(){o('#eac-account-form :input[name="currency"]').on("change",function(){var t=o(this).val(),e=o(this).closest("form");a(o(':input[name="opening_balance"]',e),t)}).trigger("change"),o('#eac-transfer-form :input[name="from_account_id"]').on("change",function(){var t=o(this).val();if(!t)return!1;var e=o(this).closest("form"),t=(c(e),{action:"eac_get_account",account_id:t,_wpnonce:eac_admin_vars.get_account_nonce});o.post(eac_admin_vars.ajax_url,t,function(t){t.success&&(t=t.data.currency,o(':input[name="currency"]',e).val(t).trigger("change"),o(':input[name="conversion_rate"]',e).val(eac_admin_vars.currencies[t].rate||1),a(o(':input[name="amount"]',e),t))}).always(function(){r(e)})}).trigger("change"),o('#eac-transfer-form :input[name="currency"]').on("change",function(){var t=o(this).val(),e=o(this).closest("form");a(o(':input[name="amount"]',e),t)}).trigger("change")}),o(n).on("init-datepicker",function(){o(":input.eac-datepicker").filter(":not(.enhanced)").each(function(){o(this).datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearRange:"-100:+0"}).addClass("enhanced")})}),o(n).on("init-tooltip",function(){o(".eac-tooltip").tooltip({tooltipClass:"eac-ui-tooltip",position:{my:"center top",at:"center bottom+10",collision:"flipfit"},hide:{duration:200},show:{duration:200}})}),o(n).on("eac-drawer-ready",function(){t()}),o(n).on("submit",".eac-ajax-form",function(t){t.preventDefault();var e=o(this),t=e.serializeAssoc();o('[form="'+e.attr("id")+'"]').is(":disabled")||(c(e),o.post(eac_admin_vars.ajax_url,t,function(t){t.success&&(e.closest(".eac-drawer").length?e.closest(".eac-drawer").data("eac_drawer").close():s(t))}).always(function(t){r(e),d(t)}))}),o(n).ready(function(){t()})}(jQuery,window,document);