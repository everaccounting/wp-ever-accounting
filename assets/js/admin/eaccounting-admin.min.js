!function(r,n){r(function(){void 0!==n&&(r(document).ajaxStart(function(){Pace.restart()}),r.extend(r.validator.messages,{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:r.validator.format("Please enter no more than {0} characters."),minlength:r.validator.format("Please enter at least {0} characters."),rangelength:r.validator.format("Please enter a value between {0} and {1} characters long."),range:r.validator.format("Please enter a value between {0} and {1}."),max:r.validator.format("Please enter a value less than or equal to {0}."),min:r.validator.format("Please enter a value greater than or equal to {0}.")}),r.validator.setDefaults({errorElement:"span",errorClass:"description error"}),r.validator.addMethod("currency_rate",function(e,a){return this.optional(a)||!/[^\d.]+/g.test(e)},"numbers, and dot only please"),window.eaccounting.currency_form={validate:function(){r("#ea-currency-form").validate({rules:{rate:{required:!0,currency_rate:!0,normalizer:function(e){return r.trim(e)}}}})},handleSubmit:function(e){e.preventDefault();var a=r(this);a.blockThis(),wp.ajax.post(a.serializeArray()).then(function(e){e=r.extend(!0,{},{message:"",redirect:""},e),console.log(e),a.unblock(),r.eaccounting_notice(e.message,"success"),eaccounting.redirect(e.redirect)}).fail(function(e){console.log(e),a.unblock(),r.eaccounting_notice(e.message,"error")})},handle_modal:function(e){var t=r(this);return r(this).ea_backbone_modal({template:"ea-modal-add-currency",onSubmit:function(e,n){n.disableSubmit(),n.$el.blockThis(),wp.ajax.post("eaccounting_edit_currency",e).then(function(e){console.log(e),n.$el.unblock(),r.eaccounting_notice(e.message,"success"),n.closeModal();var a=e.item.name+"("+e.item.symbol+")";t.eaccounting_select2({data:[{id:e.item.code,text:a,selected:!0}]}).trigger("change")}).fail(function(e){n.$el.unblock(),r.eaccounting_notice(e.message,"error"),n.enableSubmit()})}}),!1},init:function(){this.validate(),r(document).on("ready",function(){r("#ea-currency-form #code").select2(),r("#ea-currency-form #position").select2()}).on("select2:select","#ea-currency-form #code",function(e){var a=e.params.data;if(""===a.id)return!1;try{currency=n.global_currencies[a.id],r("#ea-currency-form #precision").val(currency.precision).change(),r("#ea-currency-form #position").val(currency.position).change(),r("#ea-currency-form #symbol").val(currency.symbol).change(),r("#ea-currency-form #decimal_separator").val(currency.decimal_separator).change(),r("#ea-currency-form #thousand_separator").val(currency.thousand_separator).change()}catch(e){console.log(e.message)}}).on("submit","#ea-currency-form",this.handleSubmit).on("select2:trigger_add",".eaccounting .currency_code_picker",this.handle_modal)}},eaccounting.account_form={init:function(){r(document).on("ready",function(){})}},eaccounting.currency_form.init(),r(document).on("change","#ea-account-form #currency_code",function(e){console.log("changed");var a=r(this).val().trim();if(!a)return!1;wp.ajax.post("eaccounting_get_currency",{code:a}).then(function(e){console.log(e),r("#ea-account-form #opening_balance").inputmask("decimal",{alias:"numeric",groupSeparator:e.thousand_separator,autoGroup:!0,digits:e.precision,radixPoint:e.decimal_separator,digitsOptional:!1,allowMinus:!1,prefix:e.symbol,placeholder:"0.000",rightAlign:0})}).fail(function(e){r.eaccounting_notice(e.message,"error")})}).change(),r(document).on("click",".wp-list-table .ea_item_status_update",function(){var e=r(this).data("objectid"),a=r(this).data("nonce"),n=r(this).is(":checked")?1:0,t=r(this).data("objecttype");if(!e||!a||!t)return r.eaccounting_notice("Item Missing some important property","error"),!1;wp.ajax.post("eaccounting_item_status_update",{objectid:e,nonce:a,enabled:n,objecttype:t}).then(function(e){e=r.extend(!0,{},{message:"",redirect:""},e),r.eaccounting_notice(e.message,"success")}).fail(function(e){r.eaccounting_notice(e.message,"error")})}).on("click",function(){r(".ea-dropdown").removeClass("open")}).on("click",".ea-dropdown-button",function(e){e.preventDefault(),e.stopPropagation(),r(".ea-dropdown").removeClass("open"),r(this).closest(".ea-dropdown").toggleClass("open")}).on("ea_backbone_modal_loaded",function(){r(".ea-select2").select2()}))})}(jQuery,eaccounting_admin_i10n);