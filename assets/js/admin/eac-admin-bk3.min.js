!function(h,n,c){"use strict";n.eac_admin_vars=n.eac_admin_vars||{},n.eac=n.eac||{},h.extend(n.eac,{vars:n.eac_admin_vars||{},cache:{},fn:{getCache:function(e,a){return(a=a||"default")in eac.cache||(eac.cache[a]={}),eac.cache[a][e]},setCache:function(e,a,t){(t=t||"default")in eac.cache||(eac.cache[t]={}),eac.cache[t][e]=a},removeCache:function(e,a){(a=a||"default")in eac.cache&&delete eac.cache[a][e]},flushCache:function(e){(e=e||"default")in eac.cache&&delete eac.cache[e]},notify:function(e,a){var t="body",n=!1,c=!1,i="success",o={from:"bottom",amount:50},r="right",s=250,u=450,f=4e3,d=10;if("object"==typeof e){if("data"in e&&(a=e.success&&!0===e.success?"success":"error",e=e.data),!("message"in e))return;e=e.message}if(e){if(!(e=e.trim()))return!1;var a='<div class="eac-notification notice notice-'+(a||i)+" "+(c||"")+'">',l=(a=a+e+"</div>",o.amount),i=((n?h(t).find(".eac-notification"):h(".eac-notification")).each(function(){return l=Math.max(l,parseInt(h(this).css(o.from))+this.offsetHeight+d)}),{position:"body"===t?"fixed":"absolute",margin:0,"z-index":"9999",display:"none","min-width":s,"max-width":u}),m=(i[o.from]=l+"px",h(a).css(i).appendTo(t));switch(r){case"center":m.css({left:"50%","margin-left":"-"+m.outerWidth()/2+"px"});break;case"left":m.css("left","20px");break;default:m.css("right","20px")}return m.fadeIn?m.fadeIn():m.css({display:"block",opacity:1}),m.on("timeout",function(){m.remove()}),0<f&&setTimeout(function(){m.trigger("timeout")},f),m.click(function(){m.trigger("timeout")}),m}},redirect:function(e){if("object"==typeof e){if(!("redirect"in(e="data"in e?e.data:e)))return;e=e.redirect}var a,t;if(e)return!!(e=e.trim())&&(t=-1!==(a=navigator.userAgent.toLowerCase()).indexOf("msie"),a=parseInt(a.substr(4,2),10),t&&a<9?((t=c.createElement("a")).href=e,c.body.appendChild(t),t.click()):void(n.location.href=e))},confirm:function(e,a){},confirmDelete:function(e,a){},ajax:function(e,a,t,n={}){var c=n.method||"POST",i=n.dataType||"json",n=n.url||eac.vars.ajaxurl;h.ajax({method:c,dataType:i,url:n,data:e,success:function(e){a&&a(e)},error:function(e,a,t){eac.fn.notify(t,"error")},always:function(e){t&&t(e)}})},fetch:function(e,a,t={},n={}){var c=n.method||"GET",i=n.dataType||"json",o=n.body||{},e=n.url||eac.fn.formatURL(eac.vars.rest_url+e,t);h.ajax({method:c,dataType:i,url:e,data:o,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",eac.vars.rest_nonce)},success:function(e){a&&a(e)},error:function(e,a,t){eac.fn.notify(t,"error")},always:function(e){n.always&&n.always(e)}})},getFormData:function(e){e=h(e);const t={};return h(":input",e).each(function(){var e=h(this).attr("name"),a=h(this).val();e&&(t[e]=a)}),t},formatURL:function(e,a={}){var t,n="";for(t in-1!==(e=e.replace(/\/+$/,"")).indexOf("?")?n+="&":n+="?",a)a.hasOwnProperty(t)&&(n+=encodeURIComponent(t)+"="+encodeURIComponent(a[t])+"&");return e+(n=n.slice(0,-1))},blockForm:function(e){var e=h(e),a=h('[form="'+e.attr("id")+'"]');e.find(":input").prop("disabled",!0),e.find(":submit").attr("disabled","disabled"),a.attr("disabled","disabled"),e.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblockForm:function(e){var e=h(e),a=h('[form="'+e.attr("id")+'"]');e.find(":input").prop("disabled",!1),e.find(":submit").removeAttr("disabled"),a.removeAttr("disabled"),e.unblock()},maskInput:function(e,a={}){h(e);var t=a.currency||eac.fn.getBaseCurrency().$input.inputmask("decimal",{alias:"numeric",groupSeparator:t.thousand_separator||",",autoGroup:!0,digits:precision,radixPoint:decimal_separator,digitsOptional:!1,allowMinus:!0,rightAlign:!1,prefix:"before"===position?symbol:"",suffix:"after"===position?symbol:""})},getBaseCurrency:async function(){await eac.fn.getCurrency(eac.vars.base_currency,function(e){return e})},convertCurrency:function(e,a,t,n){},getAccount:function(e,a){var t=eac.fn.getCache(e,"accounts");if(t)return a(t);eac.fn.fetch("accounts/"+e,function(e){eac.fn.setCache(e.id,e,"accounts"),a(e)})},getCurrency:async function(e){e=eac.fn.getCache(e,"currencies");if(e)return e},promise:function(t){return new Promise(function(e,a){t(e,a)})}}}),n.eac=eac,h(c).ready(function(){h(c).on("init-select2",function(){h(":input.eac-select2").filter(":not(.enhanced)").each(function(){var e={allowClear:h(this).data("allow_clear")&&!h(this).prop("multiple")||!0,placeholder:h(this).data("placeholder")||h(this).attr("placeholder")||"",minimumInputLength:h(this).data("minimum_input_length")?h(this).data("minimum_input_length"):0,ajax:{url:eac_admin_vars.ajax_url,dataType:"json",delay:250,method:"POST",data:function(e){return{term:e.term,action:h(this).data("action"),type:h(this).data("type"),_wpnonce:eac_admin_vars.search_nonce,exclude:h(this).data("exclude"),include:h(this).data("include"),limit:h(this).data("limit")}},processResults:function(e){return e.page=e.page||1,e},cache:!0}};h(this).data("action")||delete e.ajax,h(this).closest(".eac-form").length&&(e.dropdownParent=h(this).closest(".eac-form")),h(this).select2(e).addClass("enhanced")})}).on("init-datepicker",function(){h(":input.eac-datepicker").filter(":not(.enhanced)").each(function(){h(this).datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearRange:"-100:+0"}).addClass("enhanced")}),h("#eac_year_start_date").datepicker({dateFormat:"mm-dd",changeMonth:!0,changeYear:!1,yearRange:"-100:+0"})}).on("init-tooltip",function(){h(".eac-tooltip").tooltip({tooltipClass:"eac-ui-tooltip",position:{my:"center top",at:"center bottom+10",collision:"flipfit"},hide:{duration:200},show:{duration:200}})}).on("submit",".eac-ajax-form",function(e){e.preventDefault();var a=h(this),e=eac.fn.getFormData(a);eac.fn.blockForm(a),h.post(eac_admin_vars.ajax_url,e,function(e){e.success&&(a.closest(".eac-drawer").length?a.closest(".eac-drawer").data("eac_drawer").close():eac.fn.redirect(e))}).always(function(e){eac.fn.unblockForm(a),eac.fn.notify(e)})}).on("click","a.del, a.delete",function(e){if(!confirm(eac_admin_vars.i18n.confirm_delete))return e.stopPropagation(),!1}).on("block","form",function(){eac.fn.blockForm(this)}).on("unblock","form",function(){eac.fn.unblockForm(this)}).on("eac-drawer-ready",function(){eac_init()}),h(c).on("init-form",".eac-ajax-form",function(){}),h(c).on("init-form","#eac-item-form",function(){var t=h(this);h(':input[name="taxable"]',t).on("change",function(){var e="1"===h(this).val(),a=h("#field-tax_ids",t);e?a.show():a.hide()}).trigger("change")}),h(c).on("init-form","#eac-payment-form, #eac-expense-form",function(){})})}(jQuery,window,document);