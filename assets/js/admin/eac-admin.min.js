!function(p,n,c){"use strict";n.eac_admin_vars=n.eac_admin_vars||{},n.eac=n.eac||{},Object.assign(eac,{vars:n.eac_admin_vars||{},cache:{},fn:{getCache:function(e,a){return(a=a||"default")in eac.cache||(eac.cache[a]={}),eac.cache[a][e]},setCache:function(e,a,t){(t=t||"default")in eac.cache||(eac.cache[t]={}),eac.cache[t][e]=a},removeCache:function(e,a){(a=a||"default")in eac.cache&&delete eac.cache[a][e]},flushCache:function(e){(e=e||"default")in eac.cache&&delete eac.cache[e]},fetch:async function(e,t,c){c=c||"GET";const r=eac.vars.rest_url.replace(/\/+$/,"")+e;return new Promise((a,n)=>{p.ajax({url:r,method:c,data:JSON.stringify(t),contentType:"application/json",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",eac.vars.rest_nonce)},success:function(e){a(e)},error:function(e,a,t){n(new Error(t))}})})},ajax:async function(e,a,t={}){return a=a||"GET",p.ajax({url:t.url||eac.vars.ajax_url,method:a,data:JSON.stringify(e),contentType:"application/json",headers:{"X-WP-Nonce":eac.vars.nonce}})},getCurrency:async function(e){var a=eac.fn.getCache(e,"currencies");return a?Promise.resolve(a):eac.fn.fetch("/eac/v1/currencies/"+e).then(e=>(eac.fn.setCache(e.code,e,"currencies"),e))},getBaseCurrency:async function(){return eac.fn.getCurrency(eac_admin_vars.base_currency)},getExchangeRate:async function(e){return(await eac.fn.getCurrency(e)).exchange_rate||1},getAccount:async function(e){var a=eac.fn.getCache(e,"accounts");return a?Promise.resolve(a):eac.fn.fetch("/eac/v1/accounts/"+e).then(e=>(eac.fn.setCache(e.id,e,"accounts"),e))},getCustomer:async function(e){var a=eac.fn.getCache(e,"customers");return a?Promise.resolve(a):eac.fn.fetch("/eac/v1/customers/"+e).then(e=>(eac.fn.setCache(e.id,e,"customers"),e))},getVendor:async function(e){var a=eac.fn.getCache(e,"vendors");return a?Promise.resolve(a):eac.fn.fetch("/eac/v1/vendors/"+e).then(e=>(eac.fn.setCache(e.id,e,"vendors"),e))},getItem:async function(e){var a=eac.fn.getCache(e,"items");return a?Promise.resolve(a):eac.fn.fetch("/eac/v1/items/"+e).then(e=>(eac.fn.setCache(e.id,e,"items"),e))},getTax:async function(e){var a=eac.fn.getCache(e,"taxes");return a?Promise.resolve(a):eac.fn.fetch("/eac/v1/taxes/"+e).then(e=>(eac.fn.setCache(e.id,e,"taxes"),e))},getFormData:function(e){e=p(e);const t={};return p(":input",e).each(function(){var e=p(this).attr("name"),a=p(this).val();e&&(t[e]=a)}),t},blockForm:function(e){var e=p(e),a=p('[form="'+e.attr("id")+'"]');e.find(":input").prop("disabled",!0),e.find(":submit").attr("disabled","disabled"),a.attr("disabled","disabled"),e.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblockForm:function(e){var e=p(e),a=p('[form="'+e.attr("id")+'"]');e.find(":input").prop("disabled",!1),e.find(":submit").removeAttr("disabled"),a.removeAttr("disabled"),e.unblock()},notify:function(e,a){var t="body",n=!1,c=!1,r="success",o={from:"bottom",amount:50},i="right",s=250,u=450,d=4e3,f=10;if("object"==typeof e){if("data"in e&&(a=e.success&&!0===e.success?"success":"error",e=e.data),!("message"in e))return;e=e.message}if(e){if(!(e=e.trim()))return!1;var a='<div class="eac-notification notice notice-'+(a||r)+" "+(c||"")+'">',l=(a=a+e+"</div>",o.amount),r=((n?p(t).find(".eac-notification"):p(".eac-notification")).each(function(){return l=Math.max(l,parseInt(p(this).css(o.from))+this.offsetHeight+f)}),{position:"body"===t?"fixed":"absolute",margin:0,"z-index":"9999",display:"none","min-width":s,"max-width":u}),m=(r[o.from]=l+"px",p(a).css(r).appendTo(t));switch(i){case"center":m.css({left:"50%","margin-left":"-"+m.outerWidth()/2+"px"});break;case"left":m.css("left","20px");break;default:m.css("right","20px")}return m.fadeIn?m.fadeIn():m.css({display:"block",opacity:1}),m.on("timeout",function(){m.remove()}),0<d&&setTimeout(function(){m.trigger("timeout")},d),m.click(function(){m.trigger("timeout")}),m}},redirect:function(e){if("object"==typeof e){if(!("redirect"in(e="data"in e?e.data:e)))return;e=e.redirect}var a,t;if(e)return!!(e=e.trim())&&(t=-1!==(a=navigator.userAgent.toLowerCase()).indexOf("msie"),a=parseInt(a.substr(4,2),10),t&&a<9?((t=c.createElement("a")).href=e,c.body.appendChild(t),t.click()):void(n.location.href=e))},formatMoney:function(e,a){if(void 0===e||!e)return"";void 0!==a&&a||(a=eac_admin_vars.base_currency);a=eac.fn.getCurrency(a);if(!a)return"";var t=a.symbol,n=a.decimal_separator,c=a.thousand_separator,r=a.decimal_places,a=a.position,r=(e=e.toFixed(r)).split(".");switch(r[0]=r[0].split(/(?=(?:\d{3})+$)/).join(c),e=r.join(n),a){case"before":e=t+e;break;case"after":e+=t}return e},unFormatMoney:function(e,a){if(void 0===e||!e)return"";void 0!==a&&a||(a=eac_admin_vars.base_currency);var t=eac.fn.getCurrency(a).symbol,n=eac.fn.getCurrency(a).decimal_separator,c=eac.fn.getCurrency(a).thousand_separator;eac.fn.getCurrency(a).decimal_places,eac.fn.getCurrency(a).position;return e=(e=(e=e.replace(t,"")).replace(c,"")).replace(n,"."),e=parseFloat(e)},priceInput:function(e,t,a={}){t=t||eac.fn.getVar("base_currency_code");var n=eac.fn.getCurrency(t),c=n.position||"before",c=p.extend({alias:"numeric",groupSeparator:n.thousand_separator||",",autoGroup:!0,digits:n.decimal_places||2,radixPoint:n.decimal_separator||".",rightAlign:!1,digitsOptional:!1,allowMinus:!0,placeholder:"0",autoUnmask:!0,unmaskAsNumber:!0,onUnMask:function(e,a){return eac.fn.unFormatMoney(a,t)},prefix:"before"===c?n.symbol:"",suffix:"after"===c?n.symbol:""},a);p(e).inputmask("decimal",c)},select2:function(e,a={}){var t;"undefined"==typeof p.fn.select2?console.warn("Select2 is not loaded."):(e={allowClear:(t=p(e)).data("allow_clear")&&!t.prop("multiple")||!0,placeholder:t.data("placeholder")||t.attr("placeholder")||"",minimumInputLength:t.data("minimum_input_length")?t.data("minimum_input_length"):0,ajax:{url:eac_admin_vars.ajax_url,dataType:"json",delay:250,method:"POST",data:function(e){return{term:e.term,action:t.data("action"),type:t.data("type"),_wpnonce:eac_admin_vars.search_nonce,exclude:t.data("exclude"),include:t.data("include"),limit:t.data("limit")}},processResults:function(e){return e.page=e.page||1,e},cache:!0}},e=p.extend(e,a),t.data("action")||delete e.ajax,t.closest(".eac-form").length&&(e.dropdownParent=t.closest(".eac-form")),t.select2(e).addClass("enhanced"))},tooltip:function(e,a={}){"undefined"==typeof p.tooltip?console.warn("jQuery UI is not loaded."):(e=p(e),a=p.extend({tooltipClass:"eac-ui-tooltip",position:{my:"center top",at:"center bottom+10",collision:"flipfit"},hide:{duration:200},show:{duration:200}},a),e.tooltip(a))},datePicker:function(e,a={}){var t;"undefined"==typeof p.datepicker?console.warn("jQuery UI Datepicker is not loaded."):(t=p(e),e=p.extend({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearRange:"-100:+0",showButtonPanel:!0,closeText:"Clear",onClose:function(e,a){p(n.event.srcElement).hasClass("ui-datepicker-close")&&t.val("")}},a),t.datepicker(e).addClass("enhanced"))}}})}(jQuery,window,document);