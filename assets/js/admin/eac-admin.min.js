!function(r,n,i){"use strict";var c=function(e){var a=eac_admin_vars.base_currency;return(eac_admin_vars.currencies[e]||eac_admin_vars.currencies[a]).rate},o=function(e,a){var t=eac_admin_vars.base_currency,a=eac_admin_vars.currencies[a]||eac_admin_vars.currencies[t],t=a.decimal_separator,n=a.thousand_separator,i=a.precision,c=a.position,a=a.symbol;e.inputmask("decimal",{alias:"numeric",groupSeparator:n,autoGroup:!0,digits:i,radixPoint:t,digitsOptional:!1,allowMinus:!0,rightAlign:!1,prefix:"before"===c?a:"",suffix:"after"===c?a:""})},t=function(e){r('[form="'+e.attr("id")+'"]').removeAttr("disabled"),e.unblock()},s=function(e){r('[form="'+e.attr("id")+'"]').removeAttr("disabled"),e.unblock()},d=function(e){if("object"==typeof e){if(!("redirect"in(e="data"in e?e.data:e)))return;e=e.redirect}var a,t;if(e)return!!(e=e.trim())&&(t=-1!==(a=navigator.userAgent.toLowerCase()).indexOf("msie"),a=parseInt(a.substr(4,2),10),t&&a<9?((t=i.createElement("a")).href=e,i.body.appendChild(t),t.click()):void(n.location.href=e))},l=function(e,a,t){if("object"==typeof e){if("data"in e&&(a=e.success&&!0===e.success?"success":"error",e=e.data),!("message"in e))return;e=e.message}if(e){if(!(e=e.trim()))return!1;t=r.extend(!0,{},{appendTo:"body",stack:!1,customClass:!1,type:"success",offset:{from:"bottom",amount:50},align:"right",minWidth:250,maxWidth:450,delay:4e3,spacing:10},t);var a='<div class="eac-notification notice notice-'+(a||t.type)+" "+(t.customClass||"")+'">',n=(a=a+e+"</div>",t.offset.amount),e=((t.stack?r(t.appendTo).find(".eac-notification"):r(".eac-notification")).each(function(){return n=Math.max(n,parseInt(r(this).css(t.offset.from))+this.offsetHeight+t.spacing)}),{position:"body"===t.appendTo?"fixed":"absolute",margin:0,"z-index":"9999",display:"none","min-width":t.minWidth,"max-width":t.maxWidth}),i=(e[t.offset.from]=n+"px",r(a).css(e).appendTo(t.appendTo));switch(t.align){case"center":i.css({left:"50%","margin-left":"-"+i.outerWidth()/2+"px"});break;case"left":i.css("left","20px");break;default:i.css("right","20px")}return i.fadeIn?i.fadeIn():i.css({display:"block",opacity:1}),0<t.delay&&setTimeout(c,t.delay),i.click(c),i}function c(){r.eac_notification.remove(i)}};function e(){r(i).trigger("init-select2"),r(i).trigger("init-datepicker"),r(i).trigger("init-tooltip"),r(i).trigger("init-form")}r(i).on("init-select2",function(){r(":input.eac-select2").filter(":not(.enhanced)").each(function(){var e={allowClear:r(this).data("allow_clear")&&!r(this).prop("multiple")||!0,placeholder:r(this).data("placeholder")||r(this).attr("placeholder")||"",minimumInputLength:r(this).data("minimum_input_length")?r(this).data("minimum_input_length"):0,ajax:{url:eac_admin_vars.ajax_url,dataType:"json",delay:250,method:"POST",data:function(e){return{term:e.term,action:r(this).data("action"),type:r(this).data("type"),_wpnonce:eac_admin_vars.search_nonce,exclude:r(this).data("exclude"),include:r(this).data("include"),limit:r(this).data("limit")}},processResults:function(e){return e.page=e.page||1,e},cache:!0}};r(this).data("action")||delete e.ajax,r(this).closest(".eac-form").length&&(e.dropdownParent=r(this).closest(".eac-form")),r(this).select2(e).addClass("enhanced")})}),r(i).on("init-form",function(){r('.eac-ajax-form :input[name="currency"]').on("change",function(){var e=r(this).val(),a=r(this).closest("form"),t=r(':input[name="conversion_rate"]',a);o(r(':input[name="opening_balance"]',a),e),o(r(':input[name="amount"]',a),e),o(r(':input[name="price"]',a),e),e===eac_admin_vars.base_currency?(t.prop("readonly",!0),t.closest(".eac-form-field").addClass("display-none"),t.val(1),r(".eac-form-field__addon:last-child",t.closest(".eac-form-field")).text(eac_admin_vars.base_currency)):(t.prop("readonly",!1),t.closest(".eac-form-field").removeClass("display-none"),t.val(c(e)),console.log(r(".eac-form-field__addon:last-child",t).text()),r(".eac-form-field__addon:last-child",t.closest(".eac-form-field")).text(e))}).trigger("change"),r('.eac-ajax-form :input[name="from_account_id"], .eac-ajax-form :input[name="account_id"]').on("change",function(){var a=r(this).closest("form"),e=r(this).val();if(!e)return r(':input[name="currency"]',a).val(eac_admin_vars.base_currency).trigger("change"),!1;t(a);e={action:"eac_get_account",account_id:e,_wpnonce:eac_admin_vars.get_account_nonce};r.post(eac_admin_vars.ajax_url,e,function(e){console.log(e),e.success&&(e=e.data.currency,r(':input[name="currency"]',a).val(e).trigger("change"))}).always(function(){s(a)})}).trigger("change")}),r(i).on("init-datepicker",function(){r(":input.eac-datepicker").filter(":not(.enhanced)").each(function(){r(this).datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearRange:"-100:+0"}).addClass("enhanced")}),r("#eac_financial_year_start").datepicker({dateFormat:"mm-dd",changeMonth:!0,changeYear:!1,yearRange:"-100:+0"})}),r(i).on("init-tooltip",function(){r(".eac-tooltip").tooltip({tooltipClass:"eac-ui-tooltip",position:{my:"center top",at:"center bottom+10",collision:"flipfit"},hide:{duration:200},show:{duration:200}})}),r(i).on("eac-drawer-ready",function(){e()}),r(i).on("submit",".eac-ajax-form",function(e){e.preventDefault();var a=r(this),e=a.serializeAssoc();r('[form="'+a.attr("id")+'"]').is(":disabled")||(t(a),r.post(eac_admin_vars.ajax_url,e,function(e){e.success&&(a.closest(".eac-drawer").length?a.closest(".eac-drawer").data("eac_drawer").close():d(e))}).always(function(e){s(a),l(e)}))}),r(i).ready(function(){e()})}(jQuery,window,document);