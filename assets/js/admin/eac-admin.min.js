!function(s,t,l){"use strict";var i={init:function(){s(l).on("click",".eac-dropdown__button",this.toggle_dropdown).on("click",".del",this.handle_delete).on("block","form.eac-form",this.block_form).on("unblock","form.eac-form",this.unblock_form).on("submit","form.eac-form",this.submit_form).on("change",'.eac-form [name="is_taxable"]',this.toggle_tax_fields).on("eac_drawer_ready",this.triggerEvents).on("init-select2",this.init_select2).on("init-datepicker",this.init_datepicker).on("init-price-input",this.init_price_input).on("init-tooltip",this.init_tooltip).on("ready",this.triggerEvents)},triggerEvents:function(){s(l).trigger("init-select2").trigger("init-datepicker").trigger("init-price-input").trigger("init-tooltip"),console.log("bindEvents")},init_select2:function(){s(".eac-select2,select[data-ajax-type]").each(function(){var e=s(this),t={allowClear:e.data("allow_clear")&&!e.prop("multiple")||!0,placeholder:e.data("placeholder")||"",minimumInputLength:e.data("minimum_input_length")?e.data("minimum_input_length"):0,minimumResultsForSearch:10};return e.closest(".eac-form").length&&(this.options.dropdownParent=e.closest(".eac-form")),e.data("ajax-type")&&(t.ajax={url:eac_admin_vars.ajax_url,dataType:"json",method:"POST",delay:250,data:function(e){return{action:"eac_json_search",type:s(this).data("ajax-type"),_wpnonce:eac_admin_vars.json_search,term:e.term,page:e.page}},processResults:function(e,t){return t.page=t.page||1,e},cache:!0}),e.select2(t)})},init_datepicker:function(){s(".eac-field-date").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearRange:"-100:+0"}),s("#eac_financial_year_start").datepicker({dateFormat:"mm-dd",changeMonth:!0,changeYear:!1,yearRange:"-100:+0"})},init_price_input:function(){var r=eac_admin_vars.base_currency||"USD",c=eac_admin_vars.currencies||{};s("form.eac-form").each(function(){var e=s(this),t=e.find(".eac-select-currency"),i=e.find(".eac-field-money"),e=e.find('input[name="currency_rate"]'),a=t.val()||r,n=c[a]||{},o=n.rate||1;e.length&&(e.val(o),a===r?e.closest(".eac-field").hide():e.closest(".eac-field").show()),i.length&&i.inputmask("decimal",{alias:"numeric",groupSeparator:n.thousand_sep,autoGroup:!0,digits:n.precision,radixPoint:n.decimal_sep,digitsOptional:!1,allowMinus:!0,rightAlign:!1,prefix:"before"===n.position?n.symbol:"",suffix:"after"===n.position?n.symbol:""}),t.length&&t.on("change",function(){s(l).trigger("init-price-input")})})},init_tooltip:function(){s(".eac-tooltip").tooltip({tooltipClass:"eac-ui-tooltip",position:{my:"center top",at:"center bottom+10",collision:"flipfit"},hide:{duration:200},show:{duration:200}})},handle_delete:function(){if(!confirm(eac_admin_vars.i18n.delete_confirmation))return e.preventDefault(),!1},block_form:function(){var e=s(this);s('[form="'+e.attr("id")+'"]').attr("disabled","disabled"),e.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblock_form:function(){var e=s(this);s('[form="'+e.attr("id")+'"]').removeAttr("disabled"),e.unblock()},submit_form:function(e){e.preventDefault();var t=s(this),e=t.serializeAssoc();s('[form="'+t.attr("id")+'"]').is(":disabled")||(t.trigger("block"),s.post(eac_admin_vars.ajax_url,e,function(e){e.success&&(t.closest(".eac-drawer").length?t.closest(".eac-drawer").data("eac_drawer").close():s.eac_redirect(e))}).always(function(e){t.trigger("unblock"),s.eac_notification(e)}))},toggle_dropdown:function(){e.preventDefault(),e.stopPropagation(),s(this).closest(".eac-dropdown").toggleClass("is--open"),s(l).on("click",function(){s(".eac-dropdown").removeClass("is--open")})},toggle_tax_fields:function(){var e=s(this),t=e.closest(".eac-form").find(".eac-field--tax_ids");"yes"===e.val()?t.show():t.hide()}};(t.eac_admin=i).init()}(jQuery,window,document);