jQuery(function(n){"use strict";const i={title:!(n.fn.ea_modal=function(o){return this.each(function(){new n.ea_modal(this,n.extend({},n(this).data(),o))})}),onSubmit:!1,onReady:!1,submit:"Submit",url:!1};n.ea_modal=function(o,t){const e=this;this.template_id=o,this.modal_id=n(o).attr("id"),this.$template=n(o),this.options=n.extend({},i,t);o='<div class="ea-modal" tabindex="-1" role="document"><div class="ea-modal__content"><div class="ea-modal__inner"><header class="ea-modal__header"><h1 class="ea-modal__title">'+this.options.title+'&nbsp;</h1><button class="ea-modal__close dashicons">&nbsp;</button></header><div class="ea-modal__body">'+this.$template.html()+'</div><div class="ea-modal__footer"><button type="button" class="button button-secondary ea-modal__close">Cancel</button></div></div></div><div class="ea-modal__backdrop ea-modal__close">&nbsp;</div>';return this.$modal=n(o),this.$modal.find('form [type="submit"]').remove(),this.$modal.find("form").append('<input type="submit" value="submit" style="display: none;">'),this.$modal.find("form")&&this.options.submit&&((t=n('<button type="button" class="button button-primary">').html(this.options.submit)).on("click",function(){e.$modal.find('form [type="submit"]').trigger("click")}),this.$modal.find(".ea-modal__footer").append(t)),this.block=function(){n(".ea-modal__body",e.$modal).block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),n(".ea-modal__footer button",e.$modal).attr("disabled","disabled")},this.unblock=function(){n(".ea-modal__body",e.$modal).unblock(),n(".ea-modal__footer button",e.$modal).removeAttr("disabled")},this.delegate=function(){n(window).bind("resize",e.resize),n(document).bind("keydown",e.keyboard_events)},this.undelegate=function(){n(window).unbind("resize",e.resize),n(document).unbind("keydown",e.keyboard_events)},this.resize=function(){},n(".ea-modal__close",e.$modal).on("click",function(o){o.preventDefault(),e.close()}),this.keyboard_events=function(o){var t=o.keyCode||o.which;if(13===t&&e.$modal.find("form").length)return o.preventDefault(),e.$modal.find('[type="submit"]').trigger("click"),!1;27===t&&e.close()},this.close=function(){n(document.body).trigger("ea_modal_closed",[e]),n(document).off("focusin"),n(document.body).css({overflow:"auto"}).removeClass("ea-modal-open"),e.undelegate(),n(".ea-modal").remove(),n(document.body).trigger("ea_modal_removed",[e])},this.init=function(){n(document.body).css({overflow:"hidden"}).append(this.$modal).addClass("ea-modal-open"),n(".ea-modal-content",this.$modal).attr("tabindex","0").focus(),this.delegate(),this.resize(),n(document.body).trigger("ea_modal_loaded",[e]),"function"==typeof this.options.onReady&&this.options.onReady(this),n("form",e.$modal).on("submit",function(o){o.preventDefault(),e.block();const t=n("form",e.$modal).serializeObject();if("function"==typeof e.options.onSubmit)return e.options.onSubmit(t,e);n("form #action",e.$modal).length?n.post(ajaxurl,t,function(o){n.eaccounting_notice(o),o.success&&(e.close(),n(document.body).trigger("ea_modal_form_submitted",[o,e,t]))}).always(function(o){e.unblock()}):n(document.body).trigger("ea_modal_form_submitted",[e,t])})},this.init(),this}});