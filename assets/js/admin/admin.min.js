!function(c){"use strict";"undefined"==typeof eac?console.warn("eac is not defined"):c(document).ready(function(){function i(){c(document).trigger("init-select2"),c(document).trigger("init-datepicker"),c(document).trigger("init-tooltip"),c(".eac-ajax-form").filter(":not(.initiated)").each(function(){var n=c(this);n.addClass("initiated"),n.trigger("init-form"),eac.fn.ajaxForm(this)})}c(document).on("init-select2",function(){c(":input.eac-select2").filter(":not(.enhanced)").each(function(){eac.fn.select2(c(this))})}).on("init-datepicker",function(){c(":input.eac-datepicker").filter(":not(.enhanced)").each(function(){eac.fn.datepicker(c(this))}),eac.fn.datepicker(c("#eac_year_start_date",{dateFormat:"mm-dd",changeYear:!1}))}).on("init-tooltip",function(){c(".eac-tooltip").filter(":not(.enhanced)").each(function(){eac.fn.tooltip(c(this))})}).on("click","a.del, a.delete",function(n){if(!confirm(eac_admin_vars.i18n.confirm_delete))return n.stopPropagation(),!1}).on("block",".eac-ajax-form",function(){eac.fn.blockForm(this)}).on("unblock",".eac-ajax-form",function(){eac.fn.unblockForm(this)}).on("eac-drawer-ready",function(){i()}).on("init-form",".eac-ajax-form",function(){var n=c(this),t=c(':input[name="exchange_rate"]',n),e=c(':input[name="currency_code"]',n);t.length&&e.length&&e.on("change",function(){var e=c(this).val();c(".eac-form-field__addon:last-child",t.closest(".eac-form-field")).text(e),eac.api.getExchangeRate(e).then(function(n){console.log(n),t.val(n),e===eac.fn.getVar("base_currency_code")?t.closest(".eac-form-field").addClass("d-none"):t.closest(".eac-form-field").removeClass("d-none")})}),c(':input[class*="eac-input-decimal"]',n).on("keyup change",function(){var n=(n=c(this).val()).replace(/[^0-9.]/g,"");c(this).val(n)})}).on("init-form","#eac-item-form",function(){eac.fn.inputPrice(c(':input[name="price"]',this))}).on("init-form","#eac-payment-form, #eac-expense-form",function(){var n=c(this),e=c(':input[name="currency_code"]',n),t=c(':input[name="account_id"]',n),a=c(':input[name="amount"]',n);e.on("change",function(){var n=c(this).val();console.log(n),eac.fn.inputPrice(a,n)}).trigger("change"),t.on("change",function(){var n=c(this).val();eac.api.getAccount(n).then(function(n){e.val(n.currency_code).trigger("change")})}).trigger("change")}).on("init-form","#eac-account-form",function(){var e=c(this);c(':input[name="currency_code"]',e).on("change",function(){var n=c(this).val();console.log(n),eac.fn.inputPrice(c(':input[name="opening_balance"]',e),n)}).trigger("change")}).on("init-form","#eac-transfer-form",function(){var n=c(this),e=c(':input[name="from_account_id"]',n),t=c(':input[name="currency_code"]',n),a=c(':input[name="amount"]',n);e.on("change",function(){var n=c(this).val();eac.api.getAccount(n).then(function(n){t.val(n.currency_code).trigger("change")})}).trigger("change"),t.on("change",function(){var n=c(this).val();console.log(n),eac.fn.inputPrice(a,n)}).trigger("change")}).on("init-form","#eac-invoice-form",function(){var t=c(this);c(':input[name="contact_id"]',t).on("change",function(){var n=c(this).val();eac.api.getCustomer(n).then(function(n){c.each(n,function(n,e){console.log(n,e),c(':input[name="billing_'+n+'"]',t).val(e)}),t.trigger("update")})})}).on("init-form","#eac-bill-form",function(){var t=c(this);c(':input[name="contact_id"]',t).on("change",function(){var n=c(this).val();eac.api.getVendor(n).then(function(n){c.each(n,function(n,e){console.log(n,e),c(':input[name="billing_'+n+'"]',t).val(e)}),t.trigger("update")})})}).on("init-form",".eac-document-form",function(){var e=c(this);c("a.edit_billing_address",e).on("click",function(n){n.preventDefault(),c(this).hasClass("d-none")||(c(this).toggleClass("d-none"),c(".billing-fields, .billing-data",e).toggleClass("d-none"),c(".load_billing_address",e).toggle())}),c("a.add-line-item",e).on("click",function(n){n.preventDefault(),n.preventDefault();n=c(this).closest("form");c("#new-line-item",n).removeClass("d-none")}),c("a.remove-line-item",e).on("click",function(n){n.preventDefault(),c(this).closest("tr").remove(),e.trigger("update")}),c("a.calculate-totals",e).on("click",function(n){n.preventDefault(),e.data("form_data",null),e.trigger("update")}),c(':input[class*="trigger-update"]',e).on("change",function(){e.trigger("update")})}).on("update","#eac-bill-form",function(){var n=c(this),e=eac.fn.getFormData(n),t=(n.attr("id"),n.data("form_data")),a=eac.fn.getFormData(n);_.isEqual(t,a)||(eac.fn.blockForm(n),a.action="eac_calculate_bill_totals",n.load(eac.vars.ajax_url,a,function(){eac.fn.unblockForm(n),n.data("form_data",e),n.removeClass("initiated"),i()}))}).on("update","#eac-invoice-form",function(){var n=c(this),e=eac.fn.getFormData(n),t=(n.attr("id"),n.data("form_data")),a=eac.fn.getFormData(n);_.isEqual(t,a)||(eac.fn.blockForm(n),a.action="eac_calculate_invoice_totals",n.load(eac.vars.ajax_url,a,function(){eac.fn.unblockForm(n),n.data("form_data",e),n.removeClass("initiated"),i()}))}),i()})}(jQuery);